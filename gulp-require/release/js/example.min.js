$(function(){var t={$container:$(".js_container"),_pageStack:[],_configs:[],_defaultPage:null,_pageIndex:1,setDefault:function(t){return this._defaultPage=this._find("name",t),this},init:function(){var t=this;$(window).on("popstate",function(t){console.log(t.state)}),$(window).on("hashchange",function(){console.log("hashchange");var e=history.state||{},n=0===location.hash.indexOf("#")?location.hash:"#",a=t._find("url",n)||t._defaultPage;console.log(e._pageIndex+"**********"+t._pageIndex),e._pageIndex<=t._pageIndex||t._findInStack(n)?t._back(a):t._go(a)}),history.state&&history.state._pageIndex&&(this._pageIndex=history.state._pageIndex),this._pageIndex--;var e=0===location.hash.indexOf("#")?location.hash:"#",n=t._find("url",e)||t._defaultPage;return this._go(n),this},push:function(t){return this._configs.push(t),this},go:function(t){var e=this._find("name",t);e&&(location.hash=e.url)},_go:function(t){this._pageIndex++,history.replaceState&&history.replaceState({_pageIndex:this._pageIndex},"test",location.href);var e=$(t.template).html(),n=$(e).addClass("slideIn").addClass(t.name);return this.$container.append(n),this._pageStack.push({config:t,dom:n}),t.isBind||this._bind(t),this},back:function(){history.back()},_back:function(t){this._pageIndex--;var e=this._pageStack.pop();if(e){var n=0===location.hash.indexOf("#")?location.hash:"#",a=this._findInStack(n);if(!a){var i=$(t.template).html(),s=$(i).css("opacity",1).addClass(t.name);s.insertBefore(e.dom),t.isBind||this._bind(t),this._pageStack.push({config:t,dom:s})}return e.dom.addClass("slideOut").on("animationend",function(){e.dom.remove()}).on("webkitAnimationEnd",function(){e.dom.remove()}),this}},_findInStack:function(t){for(var e=null,n=0,a=this._pageStack.length;a>n;n++){var i=this._pageStack[n];if(i.config.url===t){e=i;break}}return e},_find:function(t,e){for(var n=null,a=0,i=this._configs.length;i>a;a++)if(this._configs[a][t]===e){n=this._configs[a];break}return n},_bind:function(t){var e=t.events||{};for(var n in e)for(var a in e[n])this.$container.on(a,n,e[n][a]);t.isBind=!0}},e={name:"home",url:"#",template:"#tpl_home",events:{".js_grid":{click:function(e){var n=$(this).data("id");t.go(n)}}}},n={name:"panel",url:"#panel",template:"#tpl_panel"},a={name:"button",url:"#button",template:"#tpl_button",events:{"#btn_1":{click:function(e){t.go("msg")}}}},i={name:"cell",url:"#cell",template:"#tpl_cell",events:{"#showTooltips":{click:function(){var t=$(".js_tooltips");"none"==t.css("display")&&($(".page.cell").removeClass("slideIn"),t.show(),setTimeout(function(){t.hide()},2e3))}}}},s={name:"toast",url:"#toast",template:"#tpl_toast",events:{"#showToast":{click:function(t){var e=$("#toast");"none"==e.css("display")&&(e.show(),setTimeout(function(){e.hide()},2e3))}},"#showLoadingToast":{click:function(t){var e=$("#loadingToast");"none"==e.css("display")&&(e.show(),setTimeout(function(){e.hide()},2e3))}}}},o={name:"dialog",url:"#dialog",template:"#tpl_dialog",events:{"#showDialog1":{click:function(t){var e=$("#dialog1");e.show(),e.find(".weui_btn_dialog").one("click",function(){e.hide()})}},"#showDialog2":{click:function(t){var e=$("#dialog2");e.show(),e.find(".weui_btn_dialog").one("click",function(){e.hide()})}}}},c={name:"progress",url:"#progress",template:"#tpl_progress",events:{"#btnStartProgress":{click:function(){function t(){n.css({width:e+"%"}),e=++e%100,setTimeout(t,30)}if(!$(this).hasClass("weui_btn_disabled")){$(this).addClass("weui_btn_disabled");var e=0,n=$(".js_progress");t()}}}}},l={name:"msg",url:"#msg",template:"#tpl_msg",events:{}},h={name:"article",url:"#article",template:"#tpl_article",events:{}},r={name:"tab",url:"#tab",template:"#tpl_tab",events:{".js_tab":{click:function(){var e=$(this).data("id");t.go(e)}}}},u={name:"navbar",url:"#navbar",template:"#tpl_navbar",events:{}},d={name:"tabbar",url:"#tabbar",template:"#tpl_tabbar",events:{}},_={name:"actionsheet",url:"#actionsheet",template:"#tpl_actionsheet",events:{"#showActionSheet":{click:function(){function t(t,e){t.removeClass("weui_actionsheet_toggle"),e.removeClass("weui_fade_toggle"),t.on("transitionend",function(){e.hide()}).on("webkitTransitionEnd",function(){e.hide()})}var e=$("#mask"),n=$("#weui_actionsheet");n.addClass("weui_actionsheet_toggle"),e.show().addClass("weui_fade_toggle").one("click",function(){t(n,e)}),$("#actionsheet_cancel").one("click",function(){t(n,e)}),n.unbind("transitionend").unbind("webkitTransitionEnd")}}}},p={name:"searchbar",url:"#searchbar",template:"#tpl_searchbar",events:{"#search_input":{focus:function(){var t=$("#search_bar");t.addClass("weui_search_focusing")},blur:function(){var t=$("#search_bar");t.removeClass("weui_search_focusing"),$(this).val()?$("#search_text").hide():$("#search_text").show()},input:function(){var t=$("#search_show");$(this).val()?t.show():t.hide()}},"#search_cancel":{touchend:function(){$("#search_show").hide(),$("#search_input").val("")}},"#search_clear":{touchend:function(){$("#search_show").hide(),$("#search_input").val("")}}}},f={name:"icons",url:"#icons",template:"#tpl_icons",events:{}};t.push(e).push(a).push(i).push(s).push(o).push(c).push(l).push(h).push(r).push(u).push(d).push(n).push(_).push(f).push(p).setDefault("home").init()});